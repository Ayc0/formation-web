import { Appear } from "mdx-deck";
import { Split, SplitRight } from "mdx-deck/layouts";
import { CodeSurfer } from "mdx-deck-code-surfer";

import theme from "./theme";

export { theme };

import LinkCS from "./Linkcs";

# Formation Dev Web

---

# Rappels

## HTML CSS JS

---

<LinkCS />

export default SplitRight;

## Rappels HTML

L'HTML n'est qu'une mani√®re de repr√©senter √† l'√©crit une page visuelle.

---

<LinkCS step={false} />

export default Split;

```HTML

<div>
  <button>Photo Perso</button>
  <button>Photo Cti</button>
</div>

<img
  src="uri vers la photo"
  alt="La gueule de Kangoo"
>

<div>
  Date de naissance
  01/10/1996
</div>

<div>
  Surnoms
  Milka ‚Ä¢ Kangoo ‚Ä¢ Il suffit Jonathan ‚Ä¢ Massimo
</div>

<div>
  Plaque d'immatriculation
</div>

...
```

---

import Chrono from "./Chrono";

## Qu'est-ce que le JavaScript dans tout √ßa ?

<Appear>
  <div>
    <p style={{ fontSize: theme.fontSizes[2] }}>
      Le JavaScript est un langage de programmation qui est ex√©cut√© dans le navigateur et qui permet de rendre dynamique
      vos sites.
    </p>
  </div>
  <Chrono />
</Appear>

---

# Versions

## et retrocompatibilit√©

---

# The new f-strings in Python 3.6

<br />
<br />

## python pre 3.6

`"{}".format(a)`

## python 3.6+

`f"{a}"`

---

# Gestion des versions de python

![python](./static/images/python-2-3.png)

```notes
Les dates ne servent qu'√† dire que python 2 c'est nul
```

---

# Ok, le python c'est bien beau mais c'est quoi le rapport avec le JavaScript ?

<Appear>
  <div>
    <h2 style={{ fontSize: theme.fontSizes[3], margin: "2em" }}>JavaScript n'est pas versionn√©</h2>
  </div>
  <div>
    <h2 style={{ fontSize: theme.fontSizes[3] }}>JavaScript n'a jamais de breaking changes</h2>
    <span>(√ßa c'est pour garantir qu'un site marchera toujours m√™me 20 ans apr√®s)</span>
  </div>
</Appear>

---

# JavaScript n'est pas versionn√©

- √Ä la place de faire des versions de JavaScript, des sp√©fications de fonctionnalit√©s sont ajout√©es,
- Ces fonctionnalit√©s passent par plusieurs phases d'acceptation ([d√©tails ici](https://tc39.github.io/process-document/)),
- Le commit√© [TC39](https://github.com/tc39/proposals) d√©lib√®re chaque ann√©e sur toutes ces propositions,
- Les plateformes (navigateurs, NodeJS, etc.) impl√©mentent les fonctionnalit√©s qu'ils veulent en respectant (ou non) les specs.

(c'est aussi vrai pour le CSS)

```notes
HTML 5 et CSS 3

Pas de CSS 4

Parler de ES5-6-7-8
```

---

<div>
  <h1 style={{ fontSize: "10em" }}>
    <span style={{ fontSize: "2rem", lineHeight: "2rem" }}>Comment je sais ce que je peux utiliser ?</span>
    <br />
    üò±
  </h1>
</div>

---

# Comment rem√©dier √† √ßa ?

Savoir quelles fonctionnalit√©s on peut utiliser en fonction des cibles

[caniuse.com](https://caniuse.com/) (et [kangax](http://kangax.github.io/)) <br/>
(Pour la compatibilit√©)

---

# Comment rem√©dier √† √ßa ?

Cr√©er des librairies qui permettent d'injecter des fonctionnalit√©s non existantes (ou des les ajouter si elles n'existent pas) <br/>
`from __future__ import division`

Utiliser des [polyfills ou des ponyfills](https://kikobeats.com/polyfill-ponyfill-and-prollyfill/) <br/>
(Pour l'injection automatique de fonctionnalit√©s)

```notes
D√©mo de division dans python 2 et 3
```

---

# Comment rem√©dier √† √ßa ?

Transpiler son code pour le rendre compatible <br/>
`f"Bonjour {name}"` -> `"Bonjour{name}".format(name=name)`

- [Babel](https://babeljs.io/) <br/>
  (Pour transpiler du code "r√©cent" en code "vieux")
- Pour certaines features, on ne peut rien faire (ex : Symbol)

```notes
Petite d√©mo Babel
```

---

# On ne devait pas parler de React ?

---

<CodeSurfer
  title=" "
  code={require("!!raw-loader!./static/html/first-app.html").trim()}
  lang="html"
  showNumbers
  steps={[
    { notes: "Ceci est un code valable et marche directement dans votre navigateur pr√©f√©r√©" },
    { range: [5, 6], notes: "Injection de React" },
    { lines: [7], notes: "Load babel pour <script type='text/babel'>" },
    { lines: [10, 38], notes: "Balise qui sera √©cras√©e lorsque React sera load√©" },
    { lines: [12, 39], notes: "Block de code transpil√© par Babel puis ex√©cut√© par le navigateur" },
    { lines: [20], range: [13, 16], notes: "On d√©finit un composant React" },
    { range: [26, 33], notes: "La m√©thode render correspond √† ce que le composant va afficher" },
    {
      tokens: { 29: [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17] },
      range: [22, 24],
      notes: "Lorsqu'on vient changer le contenu de l'input, la fonction handleChange est appel√©e"
    },
    {
      ranges: [[22, 24], [17, 19]],
      notes: "lorsque setState est appel√©, this.state (initialis√© au constructor) est modifi√©"
    },
    {
      tokens: { 29: [18, 19, 20, 21, 22, 23, 24, 25, 26, 27] },
      lines: [26, 30],
      notes: "La m√©thode render est appel√©e de nouveau et la valeur du state est inject√© dans l'HTML"
    }
  ]}
/>

---

# R√©sultat

<iframe
  style={{ border: "none" }}
  src={`data:text/html;charset=utf-8,${require("!!raw-loader!./static/html/first-app.html")}`}
/>

---

# React vs React-DOM

**React** = Gestion du virtual DOM

**React-DOM** = Reconciler pour le DOM, c.√†.d bindings entre le VDOM et le vrai DOM

**React-Native** = Reconciler pour Android / iOS, c.√†.d bindings entre le VDOM et des composants natifs Android ou iOS

<img
  src="https://almerosteyn.com/css/images/2017-11-15-id24-accessible-react-tips-tools-tricks/React-DOM.png"
  style={{ height: "20em" }}
/>

---

# Comment d√©finir un composant React

Avec une classe

```jsx
class MyComponent extends React.Component {
  render() {
    return <div>Ceci est le minimum requis pour cr√©er un composant</div>;
  }
}
```

Avec une fonction

```jsx
function MyComponent(props) {
  return <div>Ceci est le minimum requis pour cr√©er un composant</div>;
}
```

Avec une fonction fl√©ch√©e

```jsx
const MyComponent = props => <div>Ceci est le minimum requis pour cr√©er un composant</div>;
```

---

## Depuis React 16.8, il n'y a plus aucune diff√©rence en terme de possibilit√©s entre un composant classe et un composant fonction.

[√âquivalence entre hooks and lifecycle](https://twitter.com/prchdk/status/1056960391543062528?s=09)

---

<CodeSurfer
  title="Okay, on va dire que je te suis. Mais c'est quoi ces < > dans ton render ?"
  code={require("!!raw-loader!./static/html/first-app.html")
    .split("\n")
    .filter((_, i) => i >= 25 && i < 33)
    .join("\n")}
/>

---

# JSX

Ce n'est pas de l'html, c'est du JSX

```jsx
const App = (
  <Element prop1={value1} props2={value2}>
    <Child1 />
    <Child2 />
  </Element>
);
```

Sucre syntaxique pour (converti par Babel) :

```jsx
const App = React.createElement(
  Element,
  { prop1: value1, props2: value2 },
  React.createElement(Child1, null),
  React.createElement(Child2, null)
);
```

Notes : il faut que React soit import√© pour que le composant fonctionne car Babel r√©√©crit votre fichier avec `React.createElement`

---

# R√®gles √©l√©ments React

Tout √©l√©ment a une racine unique, si jamais vous voulez afficher plusieurs √©l√©ments JSX sans parent, utilisez `<React.Fragment>`

Don't

```jsx
const App = (
  <h1>title</h1>
  <h2>sub title</h2>
);
```

Do

```jsx
const App = (
  <React.Fragment>
    <h1>title</h1>
    <h2>sub title</h2>
  </React.Fragment>
);
```

---

# R√®gles √©l√©ments React

On utilise `{espression js}` pour injecter du code JS

Vous pouvez injecter des variables :

```jsx
const name = "World";

const App = <label>{name}</label>;
```

Ou n'importe quelle expression valide en JS :

```jsx
const condition = Math.random() > 0.5;

const App = <p style={{ visibility: condition ? "visible" : "hidden" }}>You {condition ? "can" : "can't"} see me</p>;
```

---

# R√®gles √©l√©ments React

Si vous voulez afficher une liste d'√©l√©ments JSX, il faut que vous leur donniez un attribut `key` qui permet de les traquer

```jsx
const characters = [
  {
    id: 0,
    name: "Tintin"
  },
  {
    id: 1,
    name: "Capitaine Haddock"
  },
  {
    id: 2,
    name: "Professeur Tournesol"
  },
  {
    id: 3,
    name: "Dupont"
  },
  {
    id: 4,
    name: "Dupond"
  }
];

const listOfCharacters = characters.map(character => <li key={character.id}>{character.name}</li>);

const App = <ul>{listOfCharacters}</ul>;
```

---

# R√®gles √©l√©ments React

- Si un composant retourne `null`, il n'affichera rien
- Les props et state d'un composant se doivent d'√™tre pures (c.√†.d non modifi√©)
- React fait la diff√©rence entre un √©l√©ment HTML et un √©l√©ment React gr√¢ce √† la casse :

```jsx
const Li = ({ children, title }) => (
  <li className="list" title={title}>
    {children}
  </li>
);

// Jamais appel√©
const ul = ({ children }) => <ul class="list-warpper">{children}</ul>;

const App = () => (
  <div>
    {/* div HTML */}
    <ul>
      {/* ul HTML */}
      <Li title="a">A</Li> {/* Li d√©fini au dessus */}
      <Li title="b">B</Li>
    </ul>
  </div>
);
```

---

# Immutabilit√©

‚ùóÔ∏èLes state et props sont immutables ‚ùóÔ∏è

```jsx
this.state.list.push(element); // Don't ‚ùå
this.setState(({ list }) => ({ list: list.push(element) })); // Don't ‚ùå
this.setState(({ list }) => ({ list: [...list, element] })); // Do ‚úÖ
```

Pourquoi ?

- React ne d√©tecte pas de changement donc ne va pas se re-render
- S'il se rerender quand m√™me, on a chang√© la pr√©c√©dente valeur des props ou du state et donc on ne peut plus les comparer proprement
- La mutation peut se faire √©craser par un setState prochain

En g√©n√©ral en React, tout est immutable (sauf les attributs customs).

---

# Classes

---

<CodeSurfer
  title="Il est possible de de rajouter des m√©thodes qui vont √™tre ex√©cut√©es √† des moments diff√©rents"
  code={require("!raw-loader!./static/js/SimpleComponent.js")
    .split("\n")
    .filter((_, i) => i > 1 && i <= 33)
    .join("\n")}
  steps={[
    {},
    { range: [2, 8], notes: "constructor est appel√©e lorsque le composant est cr√©e" },
    { range: [22, 31], notes: "Puis render est appel√©e pour cr√©er ce qui va √™tre affich√©" },
    {
      range: [10, 12],
      notes: "componentDidMount est appel√©e une fois que le composant a √©t√© mont√© dans le DOM (avec le visuel charg√©)"
    },
    {
      range: [22, 31],
      notes: "render est r√©-appel√© √† chaque fois que le composant doit subir un update"
    },
    {
      range: [14, 16],
      notes: "et apr√®s chaque update puis chaque mise-√†-jour du DOM, componentDidUpdate est appel√©e"
    },
    {
      range: [18, 20],
      notes:
        "Losque composant va √™tre retir√© du DOM compl√®tement, componentWillUnmount est appel√© (utile pour supprimer des listeners)"
    }
  ]}
  showNumbers
/>

---

import LifeCycle from "./LifeCycle";

# Diff√©rentes m√©thodes disponibles

[Documentation compl√®te](https://reactjs.org/docs/react-component.html)

<div style={{ display: "flex", flexDirection: "row" }}>
  <LifeCycle style={{ maxHeight: "80vh", height: "100%", flex: 2 }} />
  <div style={{ flex: 1, marginTop: "5em", fontSize: theme.fontSizes[2] }}>
    <p>
      Toutes les m√©thodes avec <b>UNSAFE</b> ne devraient plus √™tre utilis√©es car vont √™tre supprim√©es avec React 17.
    </p>
    <br />
    <p>
      Toutes les m√©thodes avec <b>STATIC</b> sont des m√©thodes de classe et pas d'instance.
    </p>
  </div>
</div>

---

# Hooks

---

<CodeSurfer
  title="Il est possible de de rajouter des m√©thodes qui vont √™tre ex√©cut√©es √† des moments diff√©rents"
  code={require("!raw-loader!./static/js/SimpleHook.js")
    .split("\n")
    .filter((_, i) => i > 1 && i <= 24)
    .join("\n")}
  steps={[
    { notes: "Tout le corps de la fonction sauf ce qui est dans useEffect va √™tre appel√©" },
    {
      ranges: [[4, 5], [9, 9]],
      notes: "ce premier useEffect est appel√© (√©quivalent √† did mount)"
    },
    {
      range: [11, 13],
      notes: "puis ce deuxi√®me useEffect est appel√© (aussi un did mount)"
    },
    {
      notes: "et apr√®s chaque update toute la fonction sauf ce qui est dans useEffect va √™tre reappel√©e"
    },
    {
      range: [11, 13],
      notes: "puis le deuxi√®me useEffect est appel√© (√©quivelent did update)"
    },
    {
      range: [6, 8],
      notes: "enfin, le callback du premier useEffect est appel√© (√©quivalent will unmount)"
    }
  ]}
  showNumbers
/>

---

# Difference hooks vs component

[Documentation compl√®te](https://reactjs.org/docs/hooks-overview.html)

R√®gles des hooks :

- L'ordre d'appel des hooks ont une importance
- Ne pas d√©finir un hook dans un if
- Tous les hooks doivent commenc√©s par "use" (m√™me les hooks customs)

B√©n√©fices des hooks :

- √Ä la place d'avoir un state "global" par composant, il faut d√©finir un `useState` par variable de state
- useEffect permet d'avoir un contr√¥le plus pr√©cis du cycle de vie du composant en incluant au sein d'une m√™me fonction les √©quivalents de `componentDidMount`, `componentDidUpdate`, `componentWillUnmount`, `shouldComponentUpdate` et `componentWillUpdate`
- Meilleure s√©gmentation de la logique pour les events listeners

D√©faults :

- Nouvelle logique => d√©veloppeurs moins habitu√©s => moins lisible
- Donne facilement du code moins lisible

---

<CodeSurfer
  title="Passer des param√®tres √† des composants"
  code={require("!raw-loader!./static/js/Logic.js").trim()}
  showNumbers
/>

---

# Manipuler le DOM

[Documentation sur les refs](https://reactjs.org/docs/refs-and-the-dom.html)

En react, pour avoir acc√®s au DOM, on utilise les `ref`.

---

<CodeSurfer title="Manipuler le DOM" code={require("!raw-loader!./static/js/Ref.js").trim()} />

---

# Bundles

---

Depuis le d√©but, on fait tourner notre code dans 1 seul fichier HTML et dans une balise `<script type="text/babel">`, mais comment fait-on pour √©crire son code dans plusieurs fichiers diff√©rents ?

- [Webpack](https://webpack.js.org/)
- [Parce](https://parceljs.org/)
- [Rollup](https://rollupjs.org/)

Tous ces outils vont prendre tout le code √©crit et le r√©unifier en 1 gros fichier (ou plusieurs plus petits en fonction de leur confs).

---

# Et si on a la flemme de r√©√©crire les m√™mes lignes de conf pour tous nos projets ?

- [create-react-app](https://facebook.github.io/create-react-app/) : Param√®tres assez complets pour g√©rer une **single-page application** en React
- [Next](https://nextjs.org/) : **Server-side rendering** tr√®s simple en React
- [Gatsby](https://www.gatsbyjs.org/) : Gestion de **sites statiques** en React avec pr√©rendu des pages en fichiers HTML statiques + hydratation

---

import ToDo from "./ToDo";

# TP

√âcrire avec [create-react-app](https://facebook.github.io/create-react-app/) une To-Do list

<ToDo />
